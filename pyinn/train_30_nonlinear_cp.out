(jax) jgz1751@athena:~/git/pyinn/pyinn$ python main.py
/mnt/b/xxd5545/parse_dataset/train_30
{'min': array([ -0.5,  -0.5,   0. ,   0. ,   1. , 100. ]), 'max': array([4.84126984e-01, 4.84126984e-01, 9.84126984e-
01, 4.00000000e-02,
       3.40000000e+00, 1.80000000e+02])}
{'min': array([ -0.5,  -0.5,   0. ,   0. ,   1. , 100. ]), 'max': array([4.84126984e-01, 4.84126984e-01, 9.84126984e-
01, 4.00000000e-02,
       2.60000000e+00, 1.53333333e+02])}
edex_max / ndex_max: 6 / 5
------------INN CP nonlinear -------------
# of training parameters: 7380
Epochs:   0%|                                                                               | 0/1000 [00:00<?, ?it/s]
Epoch 1
        Training loss: 1.4821e-01
        Training R2: -12.6598
Epochs:   1%|▌                                                                    | 9/1000 [02:35<4:42:41, 17.12s/it]
Validation loss: 1.0809e-01
        Validation R2: -11.2560
Epochs:   2%|█▎                                                                  | 19/1000 [06:06<5:01:17, 18.43s/it]
Validation loss: 6.8665e-02
        Validation R2: -6.7818
Epochs:   3%|█▉                                                                  | 29/1000 [09:24<4:45:29, 17.64s/it]
Validation loss: 4.8534e-02
        Validation R2: -4.5009
Epochs:   4%|██▋                                                                 | 39/1000 [12:42<4:46:05, 17.86s/it]
Validation loss: 3.7299e-02
        Validation R2: -3.2271
Epochs:   5%|███▎                                                                | 49/1000 [15:56<4:34:27, 17.32s/it]
Validation loss: 3.0427e-02
        Validation R2: -2.4492
Epochs:   6%|████                                                                | 59/1000 [19:09<4:30:18, 17.24s/it]
Validation loss: 2.5874e-02
        Validation R2: -1.9346
Epochs:   7%|████▋                                                               | 69/1000 [22:25<4:30:34, 17.44s/it]
Validation loss: 2.2688e-02
        Validation R2: -1.5727
Epochs:   8%|█████▎                                                              | 79/1000 [25:41<4:27:52, 17.45s/it]
Validation loss: 2.0357e-02
        Validation R2: -1.3075
Epochs:   9%|██████                                                              | 89/1000 [28:53<4:21:34, 17.23s/it]
Validation loss: 1.8582e-02
        Validation R2: -1.1067
Epochs:  10%|██████▋                                                             | 99/1000 [32:08<4:23:04, 17.52s/it]
Validation loss: 1.7203e-02
        Validation R2: -0.9502
Epochs:  11%|███████▎                                                           | 109/1000 [35:23<4:20:44, 17.56s/it]
Validation loss: 1.6095e-02
        Validation R2: -0.8242
Epochs:  12%|███████▉                                                           | 119/1000 [38:37<4:14:01, 17.30s/it]
Validation loss: 1.5181e-02
        Validation R2: -0.7206
Epochs:  13%|████████▋                                                          | 129/1000 [41:53<4:11:40, 17.34s/it]
Validation loss: 1.4423e-02
        Validation R2: -0.6340
Epochs:  14%|█████████▎                                                         | 139/1000 [45:09<4:13:54, 17.69s/it]
Validation loss: 1.3767e-02
        Validation R2: -0.5609
Epochs:  15%|█████████▉                                                         | 149/1000 [48:23<4:05:18, 17.30s/it]
Validation loss: 1.3198e-02
        Validation R2: -0.4968
Epochs:  16%|██████████▋                                                        | 159/1000 [51:38<4:05:03, 17.48s/it]
Validation loss: 1.2703e-02
        Validation R2: -0.4400
Epochs:  17%|███████████▎                                                       | 169/1000 [54:51<3:59:05, 17.26s/it]
Validation loss: 1.2258e-02
        Validation R2: -0.3900
Epochs:  18%|███████████▉                                                       | 179/1000 [58:04<3:54:34, 17.14s/it]
Validation loss: 1.1853e-02
        Validation R2: -0.3434
Epochs:  19%|████████████▎                                                    | 189/1000 [1:01:17<3:53:31, 17.28s/it]
Validation loss: 1.1472e-02
        Validation R2: -0.3009
Epochs:  20%|████████████▉                                                    | 199/1000 [1:04:30<3:51:26, 17.34s/it]
Validation loss: 1.1120e-02
        Validation R2: -0.2610
Epochs:  20%|█████████████                                                    | 200/1000 [1:05:11<5:24:34, 24.34s/it]
Epoch 201
        Training loss: 9.5401e-03
        Training R2: 0.1207
Epochs:  21%|█████████████▌                                                   | 209/1000 [1:07:45<3:50:58, 17.52s/it]
Validation loss: 1.0791e-02
        Validation R2: -0.2234
Epochs:  22%|██████████████▏                                                  | 219/1000 [1:10:58<3:44:31, 17.25s/it]
Validation loss: 1.0475e-02
        Validation R2: -0.1877
Epochs:  23%|██████████████▉                                                  | 229/1000 [1:14:12<3:42:15, 17.30s/it]
Validation loss: 1.0174e-02
        Validation R2: -0.1529
Epochs:  24%|███████████████▌                                                 | 239/1000 [1:17:26<3:42:18, 17.53s/it]
Validation loss: 9.8775e-03
        Validation R2: -0.1201
Epochs:  25%|████████████████▏                                                | 249/1000 [1:20:41<3:37:38, 17.39s/it]
Validation loss: 9.5852e-03
        Validation R2: -0.0872
Epochs:  26%|████████████████▊                                                | 259/1000 [1:23:55<3:32:50, 17.23s/it]
Validation loss: 9.2996e-03
        Validation R2: -0.0544
Epochs:  27%|█████████████████▍                                               | 269/1000 [1:27:10<3:34:32, 17.61s/it]
Validation loss: 9.0166e-03
        Validation R2: -0.0224
Epochs:  28%|██████████████████▏                                              | 279/1000 [1:30:25<3:32:50, 17.71s/it]
Validation loss: 8.7317e-03
        Validation R2: 0.0102
Epochs:  29%|██████████████████▊                                              | 289/1000 [1:33:41<3:24:37, 17.27s/it]
Validation loss: 8.4493e-03
        Validation R2: 0.0422
Epochs:  30%|███████████████████▍                                             | 299/1000 [1:36:57<3:26:35, 17.68s/it]
Validation loss: 8.1623e-03
        Validation R2: 0.0746
Epochs:  31%|████████████████████                                             | 309/1000 [1:40:12<3:21:38, 17.51s/it]
Validation loss: 7.8782e-03
        Validation R2: 0.1065
Epochs:  32%|████████████████████▋                                            | 319/1000 [1:43:25<3:18:10, 17.46s/it]
Validation loss: 7.5879e-03
        Validation R2: 0.1396
Epochs:  33%|█████████████████████▍                                           | 329/1000 [1:46:42<3:13:10, 17.27s/it]
Validation loss: 7.3015e-03
        Validation R2: 0.1729
Epochs:  34%|██████████████████████                                           | 339/1000 [1:49:57<3:10:29, 17.29s/it]
Validation loss: 7.0102e-03
        Validation R2: 0.2050
Epochs:  35%|██████████████████████▋                                          | 349/1000 [1:53:11<3:08:05, 17.34s/it]
Validation loss: 6.7162e-03
        Validation R2: 0.2379
Epochs:  36%|███████████████████████▎                                         | 359/1000 [1:56:25<3:05:07, 17.33s/it]
Validation loss: 6.4318e-03
        Validation R2: 0.2708
Epochs:  37%|███████████████████████▉                                         | 369/1000 [1:59:39<3:01:37, 17.27s/it]
Validation loss: 6.1473e-03
        Validation R2: 0.3029
Epochs:  38%|████████████████████████▋                                        | 379/1000 [2:02:53<2:59:39, 17.36s/it]
Validation loss: 5.8702e-03
        Validation R2: 0.3346
Epochs:  39%|█████████████████████████▎                                       | 389/1000 [2:06:10<2:57:41, 17.45s/it]
Validation loss: 5.5935e-03
        Validation R2: 0.3658
Epochs:  39%|█████████████████████████▍                                       | 391/1000 [2:07:07<3:44:54, 22.16s/it]
Epochs:  40%|█████████████████████████▉                                       | 399/1000 [2:09:26<2:55:22, 17.51s/it]
Validation loss: 5.3301e-03
        Validation R2: 0.3953
Epochs:  40%|██████████████████████████                                       | 400/1000 [2:10:06<4:03:54, 24.39s/it]
Epoch 401
        Training loss: 3.1117e-03
        Training R2: 0.7132
Epochs:  41%|██████████████████████████▌                                      | 409/1000 [2:12:41<2:51:55, 17.45s/it]
Validation loss: 5.0811e-03
        Validation R2: 0.4239
Epochs:  42%|███████████████████████████▏                                     | 419/1000 [2:15:54<2:46:47, 17.23s/it]
Validation loss: 4.8446e-03
        Validation R2: 0.4508
Epochs:  43%|███████████████████████████▉                                     | 429/1000 [2:19:10<2:45:09, 17.35s/it]
Validation loss: 4.6169e-03
        Validation R2: 0.4768
Epochs:  44%|████████████████████████████▌                                    | 439/1000 [2:22:25<2:42:27, 17.38s/it]
Validation loss: 4.4028e-03
        Validation R2: 0.5009
Epochs:  45%|█████████████████████████████▏                                   | 449/1000 [2:25:41<2:38:19, 17.24s/it]
Validation loss: 4.2036e-03
        Validation R2: 0.5233
Epochs:  46%|█████████████████████████████▊                                   | 459/1000 [2:28:57<2:36:30, 17.36s/it]
Validation loss: 4.0231e-03
        Validation R2: 0.5438
Epochs:  47%|██████████████████████████████▍                                  | 469/1000 [2:32:13<2:33:57, 17.40s/it]
Validation loss: 3.8544e-03
        Validation R2: 0.5631
Epochs:  48%|███████████████████████████████▏                                 | 479/1000 [2:35:26<2:29:36, 17.23s/it]
Validation loss: 3.7007e-03
        Validation R2: 0.5804
Epochs:  49%|███████████████████████████████▊                                 | 489/1000 [2:38:41<2:26:34, 17.21s/it]
Validation loss: 3.5592e-03
        Validation R2: 0.5965
Epochs:  50%|████████████████████████████████▍                                | 499/1000 [2:41:56<2:24:41, 17.33s/it]
Validation loss: 3.4274e-03
        Validation R2: 0.6113
Epochs:  51%|█████████████████████████████████                                | 509/1000 [2:45:11<2:23:31, 17.54s/it]
Validation loss: 3.3091e-03
        Validation R2: 0.6247
Epochs:  52%|█████████████████████████████████▋                               | 519/1000 [2:48:25<2:19:15, 17.37s/it]
Validation loss: 3.2035e-03
        Validation R2: 0.6367
Epochs:  53%|██████████████████████████████████▍                              | 529/1000 [2:51:43<2:17:44, 17.55s/it]
Validation loss: 3.1032e-03
        Validation R2: 0.6483
Epochs:  54%|███████████████████████████████████                              | 539/1000 [2:54:57<2:14:36, 17.52s/it]
Validation loss: 3.0121e-03
        Validation R2: 0.6585
Epochs:  55%|███████████████████████████████████▋                             | 549/1000 [2:58:13<2:10:04, 17.30s/it]
Validation loss: 2.9317e-03
        Validation R2: 0.6677
Epochs:  56%|████████████████████████████████████▎                            | 559/1000 [3:01:26<2:07:35, 17.36s/it]
Validation loss: 2.8556e-03
        Validation R2: 0.6762
Epochs:  57%|████████████████████████████████████▉                            | 569/1000 [3:04:42<2:05:54, 17.53s/it]
Validation loss: 2.7862e-03
        Validation R2: 0.6840
Epochs:  58%|█████████████████████████████████████▋                           | 579/1000 [3:07:57<2:02:37, 17.48s/it]
Validation loss: 2.7224e-03
        Validation R2: 0.6914
Epochs:  59%|██████████████████████████████████████▎                          | 589/1000 [3:11:12<1:58:10, 17.25s/it]
Validation loss: 2.6647e-03
        Validation R2: 0.6980
Epochs:  60%|██████████████████████████████████████▉                          | 599/1000 [3:14:29<1:57:56, 17.65s/it]
Validation loss: 2.6097e-03
        Validation R2: 0.7042
Epochs:  60%|███████████████████████████████████████                          | 600/1000 [3:15:10<2:43:52, 24.58s/it]
Epoch 601
        Training loss: 9.1724e-04
        Training R2: 0.9155
Epochs:  61%|███████████████████████████████████████▌                         | 609/1000 [3:17:43<1:52:48, 17.31s/it]
Validation loss: 2.5606e-03
        Validation R2: 0.7096
Epochs:  62%|████████████████████████████████████████▏                        | 619/1000 [3:20:59<1:49:53, 17.30s/it]
Validation loss: 2.5116e-03
        Validation R2: 0.7153
Epochs:  63%|████████████████████████████████████████▉                        | 629/1000 [3:24:15<1:46:39, 17.25s/it]
Validation loss: 2.4681e-03
        Validation R2: 0.7202
Epochs:  64%|█████████████████████████████████████████▌                       | 639/1000 [3:27:28<1:43:18, 17.17s/it]
Validation loss: 2.4292e-03
        Validation R2: 0.7247
Epochs:  65%|██████████████████████████████████████████▏                      | 649/1000 [3:30:45<1:42:13, 17.47s/it]
Validation loss: 2.3886e-03
        Validation R2: 0.7293
Epochs:  66%|██████████████████████████████████████████▊                      | 659/1000 [3:34:04<1:42:39, 18.06s/it]
Validation loss: 2.3530e-03
        Validation R2: 0.7331
Epochs:  67%|███████████████████████████████████████████▍                     | 669/1000 [3:37:19<1:35:04, 17.23s/it]
Validation loss: 2.3178e-03
        Validation R2: 0.7373
Epochs:  68%|████████████████████████████████████████████▏                    | 679/1000 [3:40:34<1:32:44, 17.33s/it]
Validation loss: 2.2855e-03
        Validation R2: 0.7407
Epochs:  69%|████████████████████████████████████████████▊                    | 689/1000 [3:43:49<1:30:41, 17.50s/it]
Validation loss: 2.2537e-03
        Validation R2: 0.7445
Epochs:  70%|█████████████████████████████████████████████▍                   | 699/1000 [3:47:02<1:26:23, 17.22s/it]
Validation loss: 2.2248e-03
        Validation R2: 0.7476
Epochs:  71%|██████████████████████████████████████████████                   | 709/1000 [3:50:18<1:26:15, 17.78s/it]
Validation loss: 2.1951e-03
        Validation R2: 0.7511
Epochs:  72%|██████████████████████████████████████████████▋                  | 719/1000 [3:53:34<1:21:13, 17.34s/it]
Validation loss: 2.1678e-03
        Validation R2: 0.7542
Epochs:  73%|███████████████████████████████████████████████▍                 | 729/1000 [3:56:49<1:18:23, 17.36s/it]
Validation loss: 2.1411e-03
        Validation R2: 0.7572
Epochs:  74%|████████████████████████████████████████████████                 | 739/1000 [4:00:02<1:14:55, 17.22s/it]
Validation loss: 2.1163e-03
        Validation R2: 0.7600
Epochs:  75%|████████████████████████████████████████████████▋                | 749/1000 [4:03:17<1:12:44, 17.39s/it]
Validation loss: 2.0916e-03
        Validation R2: 0.7629
Epochs:  76%|█████████████████████████████████████████████████▎               | 759/1000 [4:06:32<1:10:46, 17.62s/it]
Validation loss: 2.0690e-03
        Validation R2: 0.7655
Epochs:  77%|█████████████████████████████████████████████████▉               | 769/1000 [4:09:46<1:06:24, 17.25s/it]
Validation loss: 2.0460e-03
        Validation R2: 0.7680
Epochs:  78%|██████████████████████████████████████████████████▋              | 779/1000 [4:12:59<1:03:33, 17.26s/it]
Validation loss: 2.0246e-03
        Validation R2: 0.7704
Epochs:  79%|███████████████████████████████████████████████████▎             | 789/1000 [4:16:13<1:00:54, 17.32s/it]
Validation loss: 2.0024e-03
        Validation R2: 0.7730
Epochs:  80%|█████████████████████████████████████████████████████▌             | 799/1000 [4:19:29<58:34, 17.48s/it]
Validation loss: 1.9813e-03
        Validation R2: 0.7752
Epochs:  80%|████████████████████████████████████████████████████             | 800/1000 [4:20:13<1:24:36, 25.38s/it]
Epoch 801
        Training loss: 5.8930e-04
        Training R2: 0.9457
Epochs:  81%|██████████████████████████████████████████████████████▏            | 809/1000 [4:22:46<55:09, 17.33s/it]
Validation loss: 1.9615e-03
        Validation R2: 0.7776
Epochs:  82%|██████████████████████████████████████████████████████▊            | 819/1000 [4:26:04<53:19, 17.68s/it]
Validation loss: 1.9421e-03
        Validation R2: 0.7797
Epochs:  83%|███████████████████████████████████████████████████████▌           | 829/1000 [4:29:19<49:16, 17.29s/it]
Validation loss: 1.9237e-03
        Validation R2: 0.7818
Epochs:  84%|████████████████████████████████████████████████████████▏          | 839/1000 [4:32:34<46:25, 17.30s/it]
Validation loss: 1.9047e-03
        Validation R2: 0.7841
Epochs:  85%|████████████████████████████████████████████████████████▉          | 849/1000 [4:35:48<43:39, 17.35s/it]
Validation loss: 1.8868e-03
        Validation R2: 0.7862
Epochs:  86%|█████████████████████████████████████████████████████████▌         | 859/1000 [4:39:03<40:57, 17.43s/it]
Validation loss: 1.8690e-03
        Validation R2: 0.7881
Epochs:  87%|██████████████████████████████████████████████████████████▏        | 869/1000 [4:42:17<38:01, 17.41s/it]
Validation loss: 1.8519e-03
        Validation R2: 0.7900
Epochs:  88%|██████████████████████████████████████████████████████████▉        | 879/1000 [4:45:31<34:45, 17.24s/it]
Validation loss: 1.8363e-03
        Validation R2: 0.7918
Epochs:  89%|███████████████████████████████████████████████████████████▌       | 889/1000 [4:48:49<32:34, 17.61s/it]
Validation loss: 1.8197e-03
        Validation R2: 0.7937
Epochs:  90%|████████████████████████████████████████████████████████████▏      | 899/1000 [4:52:06<29:36, 17.59s/it]
Validation loss: 1.8050e-03
        Validation R2: 0.7954
Epochs:  91%|████████████████████████████████████████████████████████████▉      | 909/1000 [4:55:21<26:13, 17.29s/it]
Validation loss: 1.7879e-03
        Validation R2: 0.7972
Epochs:  92%|█████████████████████████████████████████████████████████████▌     | 919/1000 [4:58:36<23:26, 17.36s/it]
Validation loss: 1.7730e-03
        Validation R2: 0.7990
Epochs:  93%|██████████████████████████████████████████████████████████████▏    | 929/1000 [5:01:51<20:26, 17.28s/it]
Validation loss: 1.7591e-03
        Validation R2: 0.8005
Epochs:  94%|██████████████████████████████████████████████████████████████▉    | 939/1000 [5:05:04<17:30, 17.23s/it]
Validation loss: 1.7428e-03
        Validation R2: 0.8022
Epochs:  95%|███████████████████████████████████████████████████████████████▌   | 949/1000 [5:08:18<14:41, 17.29s/it]
Validation loss: 1.7295e-03
        Validation R2: 0.8040
Epochs:  96%|████████████████████████████████████████████████████████████████▎  | 959/1000 [5:11:33<11:55, 17.44s/it]
Validation loss: 1.7150e-03
        Validation R2: 0.8055
Epochs:  97%|████████████████████████████████████████████████████████████████▉  | 969/1000 [5:14:48<08:54, 17.23s/it]
Validation loss: 1.7013e-03
        Validation R2: 0.8072
Epochs:  98%|█████████████████████████████████████████████████████████████████▌ | 979/1000 [5:18:00<06:02, 17.26s/it]
Validation loss: 1.6872e-03
        Validation R2: 0.8087
Epochs:  99%|██████████████████████████████████████████████████████████████████▎| 989/1000 [5:21:16<03:11, 17.42s/it]
Validation loss: 1.6748e-03
        Validation R2: 0.8101
Epochs: 100%|██████████████████████████████████████████████████████████████████▉| 999/1000 [5:24:31<00:17, 17.37s/it]
Validation loss: 1.6607e-03
        Validation R2: 0.8118
Epochs: 100%|██████████████████████████████████████████████████████████████████| 1000/1000 [5:25:12<00:00, 19.51s/it]
INN training took 19512.2311 seconds
Test
        Test loss: 1.6605e-03
        Test R2: 0.8117
        Test took 23.8573 seconds
        Inference time: 0.0007 seconds
Traceback (most recent call last):
  File "/home/jgz1751/git/pyinn/pyinn/main.py", line 56, in <module>
    plot.plot_regression(regressor, data, config)
  File "/home/jgz1751/git/pyinn/pyinn/plot.py", line 47, in plot_regression
    plot_modes(model, cls_data, plot_in_axis, plot_out_axis)
  File "/home/jgz1751/git/pyinn/pyinn/plot.py", line 139, in plot_modes
    xmin, xmax = cls_data.x_data_minmax["min"][plot_in_axis[i]], cls_data.x_data_minmax["max"][plot_in_axis[i]]
                                               ~~~~~~~~~~~~^^^
IndexError: list index out of range
(jax) jgz1751@athena:~/git/pyinn/pyinn$ ^C
(jax) jgz1751@athena:~/git/pyinn/pyinn$ ^C
(jax) jgz1751@athena:~/git/pyinn/pyinn$ tmux capture-pane -pS -300 > file.out

